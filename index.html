<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Eugen Dimant | Research</title>

  <meta name="description" content="Eugen Dimant is an Associate Professor of Practice in Behavioral and Decision Sciences at the University of Pennsylvania and a Visiting Professor at Stanford University. Research on behavioral economics, social norms, trust, polarization, honesty, corruption, and migration." />
  <meta name="theme-color" content="#0b0d10" />
  <meta name="color-scheme" content="light dark" />

  <meta property="og:title" content="Eugen Dimant | Research" />
  <meta property="og:description" content="Behavioral economics, social norms, trust, polarization, honesty, corruption, and migration." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="assets/eugen_dimant.jpg" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%237dd3fc'/%3E%3Cstop offset='1' stop-color='%23a78bfa'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='%230b0d10'/%3E%3Cpath d='M18 44V20h12c7 0 11 4 11 10s-4 10-11 10H28v4h-10zm10-12h2c2 0 3-1 3-2s-1-2-3-2h-2v4z' fill='url(%23g)'/%3E%3C/svg%3E" />

  <style>
    :root{
      --bg:#0b0d10;
      --bg2:#0f1216;
      --card:#121720;
      --card2:#0f141d;
      --text:#eaf0f8;
      --muted:#b4c0d3;
      --muted2:#8ea0ba;
      --border:rgba(255,255,255,.12);
      --shadow:0 16px 40px rgba(0,0,0,.35);
      --shadow2:0 8px 24px rgba(0,0,0,.25);
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --radius:18px;
      --radius2:26px;
      --max:1120px;
      --pad:clamp(18px,3.2vw,28px);
      --pad2:clamp(12px,2.4vw,18px);
      --font:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f7fb;
        --bg2:#ffffff;
        --card:#ffffff;
        --card2:#fbfcff;
        --text:#0b1220;
        --muted:#44556f;
        --muted2:#5b6c87;
        --border:rgba(0,0,0,.10);
        --shadow:0 18px 40px rgba(0,0,0,.08);
        --shadow2:0 10px 24px rgba(0,0,0,.08);
        --accent:#0284c7;
        --accent2:#7c3aed;
      }
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 18% -10%, rgba(125,211,252,.22), transparent 55%),
        radial-gradient(1000px 700px at 110% 10%, rgba(167,139,250,.18), transparent 55%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg2) 55%, var(--bg) 100%);
      line-height:1.55;
    }
    a{color:inherit}
    a:hover{text-decoration:underline}
    .wrap{max-width:var(--max); margin:0 auto; padding:0 var(--pad)}
    .skip{
      position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden;
    }
    .skip:focus{
      left:var(--pad); top:var(--pad);
      width:auto; height:auto; padding:10px 12px;
      background:var(--card); border:1px solid var(--border); border-radius:12px; z-index:9999;
    }

    header{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(12px);
      background: color-mix(in srgb, var(--bg2) 78%, transparent);
      border-bottom:1px solid var(--border);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 0; gap:14px;
    }
    .brand{
      display:flex; flex-direction:column; line-height:1.12; min-width:240px;
    }
    .brand strong{font-size:16px; letter-spacing:.2px}
    .brand span{font-size:12px; color:var(--muted2); margin-top:2px}
    nav ul{
      list-style:none; margin:0; padding:0;
      display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end;
    }
    nav a{
      display:inline-flex; align-items:center;
      padding:9px 12px;
      border:1px solid transparent;
      border-radius:999px;
      color:var(--muted);
      font-size:13px;
      transition:background 140ms ease, border-color 140ms ease, color 140ms ease, transform 140ms ease;
      text-decoration:none;
      white-space:nowrap;
    }
    nav a:hover{
      background: color-mix(in srgb, var(--card) 70%, transparent);
      border-color: var(--border);
      color: var(--text);
      transform: translateY(-1px);
    }
    nav a.active{
      background: color-mix(in srgb, var(--card) 88%, transparent);
      border-color: color-mix(in srgb, var(--accent) 60%, var(--border));
      color: var(--text);
    }

    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card) 88%, transparent);
      color: var(--text);
      font-size:13px;
      cursor:pointer;
      transition: transform 120ms ease, background 140ms ease, border-color 140ms ease;
      text-decoration:none;
      white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: color-mix(in srgb, var(--accent) 55%, var(--border));
      background: color-mix(in srgb, var(--card) 95%, transparent);
      text-decoration:none;
    }
    .btn-primary{
      border-color: color-mix(in srgb, var(--accent) 65%, var(--border));
      background: linear-gradient(135deg,
        color-mix(in srgb, var(--accent) 34%, var(--card)) 0%,
        color-mix(in srgb, var(--accent2) 28%, var(--card)) 100%);
    }
    .btn-ghost{
      background: transparent;
      border-color: var(--border);
      color: var(--muted);
    }
    .btn-ghost:hover{ color: var(--text); }

    main{ padding: 22px 0 70px; }
    section{ scroll-margin-top: 90px; }
    .hero{
      padding: 26px 0 12px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 26px;
      align-items: stretch;
    }
    @media (max-width: 920px){
      .hero{ grid-template-columns: 1fr; }
      .brand{ min-width: auto; }
    }

    .panel{
      background: color-mix(in srgb, var(--card) 88%, transparent);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius2);
      padding: var(--pad);
    }
    .hero h1{
      margin:0 0 10px;
      font-size: clamp(26px, 3.4vw, 44px);
      line-height: 1.08;
      letter-spacing: -0.4px;
    }
    .hero p{
      margin: 0 0 16px;
      color: var(--muted);
      font-size: 15px;
      max-width: 70ch;
    }
    .kpi-row{
      display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px;
    }
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card2) 78%, transparent);
      color: var(--muted);
      font-size: 12px;
      text-decoration:none;
    }
    .pill b{ color: var(--text); font-weight: 600; }
    .actions{
      display:flex; gap:10px; flex-wrap:wrap; margin-top: 16px;
    }

    .profile{
      display:grid;
      grid-template-columns: 110px 1fr;
      gap: 14px;
      align-items:center;
    }
    .avatar{
      width:110px; height:110px; border-radius: 22px;
      border:1px solid var(--border);
      background: linear-gradient(135deg,
        color-mix(in srgb, var(--accent) 28%, var(--card)) 0%,
        color-mix(in srgb, var(--accent2) 24%, var(--card)) 100%);
      box-shadow: var(--shadow2);
      overflow:hidden;
      position: relative;
    }
    .avatar img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
    }
    .avatar .fallback{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      color: var(--text);
      font-weight: 700;
      letter-spacing: .4px;
      opacity: .85;
      font-size: 22px;
    }
    .mini{
      color: var(--muted2);
      font-size: 12px;
      margin-top: 2px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-top: 16px;
    }
    @media (max-width: 920px){ .grid{ grid-template-columns: 1fr; } }

    .card{
      background: color-mix(in srgb, var(--card) 90%, transparent);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      padding: var(--pad2);
    }
    .card h2{
      margin: 2px 0 10px;
      font-size: 16px;
      letter-spacing: .2px;
    }
    .card h3{
      margin: 2px 0 6px;
      font-size: 14px;
      letter-spacing: .2px;
    }
    .card p, .card li{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
    }
    .card ul{
      margin: 10px 0 0;
      padding-left: 18px;
    }
    .card li{ margin: 6px 0; }
    .muted{ color: var(--muted); }

    .section-title{
      margin: 34px 0 10px;
      font-size: 14px;
      letter-spacing: .16em;
      text-transform: uppercase;
      color: var(--muted2);
    }

    /* Publications explorer */
    .explorer{
      display:grid;
      grid-template-columns: 340px 1fr;
      gap: 16px;
      align-items:start;
    }
    @media (max-width: 980px){
      .explorer{ grid-template-columns: 1fr; }
    }
    .filters{
      position: sticky;
      top: 84px;
    }
    @media (max-width: 980px){
      .filters{ position: static; top: auto; }
    }
    label{
      display:block;
      font-size: 12px;
      color: var(--muted2);
      margin: 12px 0 6px;
    }
    input[type="text"], select{
      width:100%;
      padding: 11px 12px;
      border-radius: 14px;
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card2) 84%, transparent);
      color: var(--text);
      outline: none;
    }
    input[type="text"]::placeholder{ color: color-mix(in srgb, var(--muted2) 78%, transparent); }
    .row{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      margin-top: 12px;
    }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card2) 78%, transparent);
      color: var(--muted);
      font-size: 12px;
      cursor:pointer;
      user-select:none;
      transition: background 140ms ease, border-color 140ms ease, transform 120ms ease, color 140ms ease;
    }
    .chip:hover{
      transform: translateY(-1px);
      border-color: color-mix(in srgb, var(--accent) 55%, var(--border));
      color: var(--text);
    }
    .chip.active{
      background: color-mix(in srgb, var(--accent) 18%, var(--card));
      border-color: color-mix(in srgb, var(--accent) 60%, var(--border));
      color: var(--text);
    }
    .chip small{
      color: var(--muted2);
      font-size: 11px;
    }

    .toggle{
      display:flex; gap:10px; align-items:center;
      padding: 10px 12px;
      border-radius: 14px;
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card2) 78%, transparent);
      margin-top: 10px;
    }
    .toggle input{ transform: translateY(1px); }
    .toggle span{ color: var(--muted); font-size: 12px; }

    .tabs{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-bottom: 10px;
    }
    .tab{
      padding: 9px 12px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: transparent;
      color: var(--muted);
      cursor:pointer;
      font-size: 13px;
    }
    .tab.active{
      background: color-mix(in srgb, var(--card) 88%, transparent);
      border-color: color-mix(in srgb, var(--accent) 60%, var(--border));
      color: var(--text);
    }

    .results-head{
      display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      margin-bottom: 10px;
    }
    .count{
      color: var(--muted);
      font-size: 13px;
    }
    .right-tools{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .select-sm{ width:auto; min-width: 180px; }

    .pub-list{ display:flex; flex-direction:column; gap:12px; }
    .year-block{
      margin-top: 14px;
      padding-top: 6px;
    }
    .year-title{
      display:flex; align-items:center; justify-content:space-between;
      gap: 12px;
      margin: 6px 0 6px;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
    }
    .year-title h3{
      margin:0;
      font-size: 16px;
      letter-spacing:.2px;
    }
    .year-title .jump{
      color: var(--muted2);
      font-size: 12px;
      text-decoration:none;
    }

    .pub{
      border-radius: var(--radius);
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card) 90%, transparent);
      box-shadow: var(--shadow2);
      padding: var(--pad2);
    }
    .pub .top{
      display:flex; gap:10px; justify-content:space-between; flex-wrap:wrap; align-items:flex-start;
    }
    .pub h4{
      margin: 0;
      font-size: 14px;
      letter-spacing:.1px;
      line-height: 1.35;
      max-width: 78ch;
    }
    .pub .meta{
      margin-top: 6px;
      color: var(--muted);
      font-size: 12.5px;
    }
    .pub .meta em{ color: var(--muted2); font-style: normal; }
    .pub .badges{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      padding: 6px 8px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: color-mix(in srgb, var(--card2) 78%, transparent);
      color: var(--muted);
      font-size: 11px;
    }
    .badge strong{ color: var(--text); font-weight: 650; }
    .badge.ok{ border-color: color-mix(in srgb, var(--ok) 55%, var(--border)); }
    .badge.warn{ border-color: color-mix(in srgb, var(--warn) 55%, var(--border)); }

    .pub .links{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-top: 10px;
    }
    .link{
      display:inline-flex; align-items:center; justify-content:center;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: transparent;
      color: var(--muted);
      font-size: 12px;
      text-decoration:none;
      transition: background 140ms ease, border-color 140ms ease, color 140ms ease, transform 120ms ease;
    }
    .link:hover{
      transform: translateY(-1px);
      background: color-mix(in srgb, var(--card2) 80%, transparent);
      border-color: color-mix(in srgb, var(--accent) 55%, var(--border));
      color: var(--text);
      text-decoration:none;
    }
    .link.primary{
      background: color-mix(in srgb, var(--accent) 16%, var(--card));
      border-color: color-mix(in srgb, var(--accent) 60%, var(--border));
      color: var(--text);
    }

    .toast{
      position: fixed;
      right: 16px;
      bottom: 16px;
      max-width: min(520px, calc(100vw - 32px));
      background: color-mix(in srgb, var(--card) 92%, transparent);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: 16px;
      padding: 12px 14px;
      color: var(--text);
      font-size: 13px;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 160ms ease, transform 160ms ease;
      pointer-events: none;
      z-index: 1000;
    }
    .toast.show{ opacity: 1; transform: translateY(0); }

    /* Vita PDF */
    .pdf-wrap{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      background: color-mix(in srgb, var(--card2) 86%, transparent);
      box-shadow: var(--shadow2);
    }
    .pdf-toolbar{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
    }
    .pdf-toolbar .left{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    iframe.pdf{
      width: 100%;
      height: min(78vh, 860px);
      border: 0;
      display:block;
      background: var(--bg2);
    }

    footer{
      padding: 24px 0 40px;
      color: var(--muted2);
      font-size: 12px;
    }
    .footrow{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .footrow a{ color: var(--muted2); text-decoration:none; }
    .footrow a:hover{ text-decoration:underline; }
    code.kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: color-mix(in srgb, var(--card2) 78%, transparent);
      color: var(--muted);
    }
  </style>
</head>

<body>
  <a class="skip" href="#main">Skip to content</a>

  <header>
    <div class="wrap">
      <div class="nav">
        <div class="brand" aria-label="Site title">
          <strong>Eugen Dimant</strong>
          <span>Behavioral Economics · Social Norms · Trust · Polarization</span>
        </div>

        <nav aria-label="Primary">
          <ul>
            <li><a href="#home" data-nav>Home</a></li>
            <li><a href="#research" data-nav>Research</a></li>
            <li><a href="#vita" data-nav>Vita</a></li>
            <li><a href="#misc" data-nav>Misc</a></li>
            <li><a href="#contact" data-nav>Contact</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <main id="main" class="wrap">
    <section id="home" aria-label="Home">
      <div class="hero">
        <div class="panel">
          <h1>Associate Professor of Practice at UPenn · Visiting Professor at Stanford</h1>
          <p>
            I am an Associate Professor of Practice in Behavioral and Decision Sciences at the University of Pennsylvania
            and a Visiting Professor at Stanford University. I am also a fellow at both the Behavioral and Decision Sciences Program
            and the Center for Social Norms and Behavioral Dynamics at the University of Pennsylvania, a collaborator at the Behavior Change for Good Initiative (BCFG) at Wharton,
            and a Network Fellow at CESifo.
          </p>

          <div class="actions" aria-label="Quick actions">
            <a class="btn btn-primary" href="#research">Explore publications</a>
            <a class="btn" href="#vita">CV preview</a>
            <a class="btn btn-ghost" href="mailto:edimant@sas.upenn.edu">Email</a>
          </div>

          <div class="kpi-row" aria-label="Highlights">
            <span class="pill"><b>Focus</b> norms, honesty, polarization, corruption, migration</span>
            <span class="pill"><b>Methods</b> lab + field experiments, causal inference, observational data</span>
            <span class="pill"><b>Goal</b> research that travels to policy and practice</span>
          </div>
        </div>

        <div class="panel">
          <div class="profile">
            <div class="avatar" aria-label="Portrait">
              <img
                src="https://kingcenter.stanford.edu/sites/g/files/sbiybj16611/files/styles/large_square/public/media/image/eugen_dimant_0.jpg?h=c12f1a1d&itok=Od2bdbDX"
                alt="Portrait of Eugen Dimant"
                referrerpolicy="no-referrer"
                onerror="this.onerror=null; this.src='assets/eugen_dimant.jpg';"
              />
              <div class="fallback" aria-hidden="true">ED</div>
            </div>
            <div>
              <div style="font-weight:700; font-size:14px; letter-spacing:.2px;">Eugen Dimant</div>
              <div class="mini">University of Pennsylvania · Stanford University</div>

              <div class="row" style="margin-top:10px;">
                <a class="btn" href="https://sites.google.com/view/eugendimant/" target="_blank" rel="noreferrer noopener">Legacy site</a>
                <button class="btn btn-ghost" id="copyLinkBtn" type="button">Copy site link</button>
              </div>

              <div class="row" style="margin-top:10px;">
                <a class="pill" href="https://www.linkedin.com/in/eugendimant/" target="_blank" rel="noreferrer noopener">LinkedIn</a>
                <a class="pill" href="https://www.cesifo.org/en/network-member/dimant-eugen" target="_blank" rel="noreferrer noopener">CESifo</a>
                <a class="pill" href="https://papers.ssrn.com/sol3/cf_dev/AbsByAuth.cfm?per_id=2061825" target="_blank" rel="noreferrer noopener">SSRN</a>
              </div>
            </div>
          </div>

          <div class="grid" style="margin-top:16px;">
            <div class="card">
              <h2>Research news</h2>
              <ul>
                <li><b>Apr 2025:</b> new publications on social norms and norm heterogeneity in 6 top journals.</li>
                <li><b>Nov 2024:</b> new publications in Management Science, The Economic Journal, PNAS Nexus, and European Economic Review.</li>
                <li><b>Jun 2023:</b> new publications in PNAS Nexus and Games and Economic Behavior.</li>
                <li><b>Sep 2022:</b> new publication in Nature and multiple others on COVID-19 and compliance.</li>
              </ul>
              <p style="margin-top:10px" class="muted">See the full list and filter by year and topics in the Research section.</p>
            </div>

            <div class="card">
              <h2>Selected publications</h2>
              <ul>
                <li>Nudging Teachers: A Megastudy To Increase Math Achievement Among 3 Million Elementary School Students (PNAS, 2025).</li>
                <li>Strategic Behavior with Tight, Loose, and Polarized Norms (Management Science, 2024).</li>
                <li>Paying Them to Hate US: Effect of U.S. Military Aid on Anti-American Terrorism, 1968-2018 (The Economic Journal, 2024).</li>
                <li>Social Norms and Behavior Change: The Interdisciplinary Research Frontier (JEBO, 2022).</li>
                <li>It’s Not A Lie if You Believe the Norm Does Not Apply (Games and Economic Behavior, 2023).</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="section-title">Research</div>
    <section id="research" aria-label="Research">
      <div class="explorer">
        <div class="panel filters" aria-label="Filters">
          <div class="tabs" role="tablist" aria-label="Publication type">
            <button class="tab active" type="button" data-tab="peer" role="tab" aria-selected="true">Peer-reviewed</button>
            <button class="tab" type="button" data-tab="wip" role="tab" aria-selected="false">Work in progress</button>
          </div>

          <label for="q">Search title, venue, authors</label>
          <input id="q" type="text" placeholder="Try: norms, polarization, honesty, migration, corruption" autocomplete="off" />

          <label>Year</label>
          <div id="yearChips" class="row" aria-label="Year filter"></div>

          <label>Topics (from titles)</label>
          <div id="topicChips" class="row" aria-label="Topic filter"></div>

          <div class="toggle">
            <input id="onlyOpen" type="checkbox" />
            <span>Show only items with an open PDF or ungated link</span>
          </div>

          <div class="toggle">
            <input id="groupByYear" type="checkbox" checked />
            <span>Group results by year</span>
          </div>

          <div class="row" style="margin-top:12px;">
            <button class="btn" id="resetBtn" type="button">Reset</button>
            <button class="btn btn-ghost" id="shareBtn" type="button">Copy filtered link</button>
          </div>

          <p class="muted" style="margin:12px 0 0; font-size:12px;">
            Tip: you can also jump quickly by selecting a year chip and then using <code class="kbd">Ctrl</code> + <code class="kbd">F</code>.
          </p>
        </div>

        <div class="panel" aria-label="Results">
          <div class="results-head">
            <div class="count" id="count"></div>
            <div class="right-tools">
              <select id="sort" class="select-sm" aria-label="Sort">
                <option value="year_desc">Sort: newest</option>
                <option value="year_asc">Sort: oldest</option>
                <option value="title_asc">Sort: title A–Z</option>
              </select>
              <select id="jumpYear" class="select-sm" aria-label="Jump to year">
                <option value="">Jump to year…</option>
              </select>
            </div>
          </div>

          <div id="list" class="pub-list" aria-live="polite"></div>
        </div>
      </div>
    </section>

    <div class="section-title">Vita</div>
    <section id="vita" aria-label="Vita">
      <div class="panel">
        <h2 style="margin:0 0 8px;">Curriculum Vitae</h2>
        <p class="muted" style="margin:0 0 14px;">
          Scroll the embedded PDF below, or download it. To update: replace <code class="kbd">cv.pdf</code> in this GitHub repository and commit.
        </p>

        <div class="pdf-wrap">
          <div class="pdf-toolbar">
            <div class="left">
              <a class="btn btn-primary" href="cv.pdf" download>Download CV</a>
              <a class="btn" href="cv.pdf" target="_blank" rel="noreferrer noopener">Open in new tab</a>
            </div>
            <div class="muted" style="font-size:12px;">File: <code class="kbd">cv.pdf</code></div>
          </div>

          <iframe class="pdf" src="cv.pdf#view=FitH" title="CV preview (PDF)"></iframe>
        </div>

        <p class="muted" style="margin:12px 0 0; font-size:12px;">
          If the preview is blank on some devices, use “Open in new tab”.
        </p>
      </div>
    </section>

    <div class="section-title">Misc</div>
    <section id="misc" aria-label="Miscellaneous">
      <div class="panel">
        <h2 style="margin:0 0 8px;">Profiles and links</h2>
        <p class="muted" style="margin:0 0 14px;">Quick access to places where people often search for papers, citations, and working drafts.</p>

        <div class="grid">
          <div class="card">
            <h3>Academic profiles</h3>
            <ul>
              <li><a href="https://www.cesifo.org/en/network-member/dimant-eugen" target="_blank" rel="noreferrer noopener">CESifo</a></li>
              <li><a href="https://ideas.repec.org/f/pdi226.html" target="_blank" rel="noreferrer noopener">IDEAS / RePEc</a></li>
              <li><a href="https://www.nber.org/people/eugen_dimant" target="_blank" rel="noreferrer noopener">NBER profile (if applicable)</a></li>
              <li><a href="https://www.academia.edu/61107824/Eugen_Dimant" target="_blank" rel="noreferrer noopener">Academia.edu</a></li>
              <li><a href="https://papers.ssrn.com/sol3/cf_dev/AbsByAuth.cfm?per_id=2061825" target="_blank" rel="noreferrer noopener">SSRN</a></li>
            </ul>
          </div>

          <div class="card">
            <h3>Social and discovery</h3>
            <ul>
              <li><a href="https://www.linkedin.com/in/eugendimant/" target="_blank" rel="noreferrer noopener">LinkedIn</a></li>
              <li><a href="https://www.researchgate.net/profile/Eugen-Dimant" target="_blank" rel="noreferrer noopener">ResearchGate</a></li>
              <li><a href="https://scholar.google.com/scholar?q=Eugen+Dimant" target="_blank" rel="noreferrer noopener">Google Scholar (search)</a></li>
              <li><a href="#research">Publications explorer</a></li>
              <li><a href="#vita">CV preview</a></li>
            </ul>
            <p class="muted" style="margin-top:10px; font-size:12px;">Note: Google Scholar pages sometimes block embedding; linking to search is reliable.</p>
          </div>
        </div>
      </div>
    </section>

    <div class="section-title">Contact</div>
    <section id="contact" aria-label="Contact">
      <div class="panel">
        <h2 style="margin:0 0 8px;">Contact details</h2>

        <div class="grid">
          <div class="card">
            <h3>Email</h3>
            <p><a href="mailto:edimant@sas.upenn.edu">edimant@sas.upenn.edu</a></p>
            <p class="muted" style="margin-top:8px;">Fastest for speaking requests, student matters, and collaboration.</p>
          </div>

          <div class="card">
            <h3>Affiliations</h3>
            <ul>
              <li>Behavioral and Decision Sciences Program (UPenn)</li>
              <li>Center for Social Norms and Behavioral Dynamics (UPenn)</li>
              <li>Behavior Change for Good Initiative (BCFG), Wharton</li>
              <li>CESifo Network Fellow</li>
            </ul>
            <p class="muted" style="margin-top:10px;">
              Program page: <a href="https://mbds.sas.upenn.edu/" target="_blank" rel="noreferrer noopener">mbds.sas.upenn.edu</a>
            </p>
          </div>
        </div>
      </div>
    </section>

    <footer class="wrap">
      <div class="footrow">
        <div>© <span id="yearNow"></span> Eugen Dimant</div>
        <div style="display:flex; gap:12px; flex-wrap:wrap;">
          <a href="#home">Top</a>
          <a href="#research">Research</a>
          <a href="#vita">Vita</a>
          <a href="https://sites.google.com/view/eugendimant/" target="_blank" rel="noreferrer noopener">Legacy site</a>
        </div>
      </div>
    </footer>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <noscript>
    <div class="wrap" style="padding:18px 0 60px;">
      <div class="panel">
        JavaScript is disabled. The publications explorer needs JavaScript. You can still use the legacy site link above.
      </div>
    </div>
  </noscript>

  <script>
    // -------------------------
    // Data (from your legacy Google Sites pages)
    // -------------------------
    const pubs = [
      // 2025
      {
        year: 2025, type: "peer",
        title: "Nudging Teachers: A Megastudy To Increase Math Achievement Among 3 Million Elementary School Students",
        authors: "with A. Duckworth, K. Milkman & BCFG Collective",
        venue: "Proceedings of the National Academy of Sciences (PNAS)",
        links: {
          paper: "https://doi.org/10.1073/pnas.2418616122",
          open: "https://drive.google.com/file/d/1b5fPBMT2eOilEqVr1pFjf6_Ytp6NENCx/view"
        }
      },
      {
        year: 2025, type: "peer",
        title: "Experimental Methods: Eliciting and Measuring Social Norms",
        authors: "with G. Charness, U. Gneezy & E. Krupka",
        venue: "Journal of Economic Behavior & Organization",
        links: {}
      },
      {
        year: 2025, type: "peer",
        title: "The 'I' in Egalitarianism: Hadza Hunter-Gatherers Averse to Inequality Primarily when Personally Unfavourable",
        authors: "with K. Smith, D. N. E. Stibbard-Hawkes, I. A. Mabulla, C. Bicchieri & C. Apicella",
        venue: "Proceedings of the National Academy of Sciences (PNAS) Nexus",
        links: {}
      },
      {
        year: 2025, type: "peer",
        title: "Racial Identity, Reactions to Inequality & Fairness Concepts Among Americans",
        authors: "with L. Reinhardt & N. Sambanis",
        venue: "Accepted at: Journal of Experimental Political Science",
        links: {}
      },
      {
        year: 2025, type: "peer",
        title: "The Science of Honesty: A Review and Research Agenda",
        authors: "Collaboration led by S. Shalvi",
        venue: "Advances in Experimental Social Psychology",
        links: {}
      },
      {
        year: 2025, type: "peer",
        title: "Norm-Nudging: Harnessing Social Expectations for Behavior Change",
        authors: "with C. Bicchieri",
        venue: "Elgar Encyclopedia of Behavioural and Experimental Economics",
        links: {}
      },

      // 2024
      {
        year: 2024, type: "peer",
        title: "Strategic Behavior with Tight, Loose, and Polarized Norms",
        authors: "with M. Gelfand, A. Hochleitner & S. Sonderegger",
        venue: "Management Science",
        links: { paper: "https://doi.org/10.1287/mnsc.2023.01022", open: "https://drive.google.com/file/d/1N_ugrMwPomlefoFRgILd9vSqW33TzkvZ/view" }
      },
      {
        year: 2024, type: "peer",
        title: "Hate Trumps Love: The Impact of Political Polarization on Social Preferences",
        authors: "",
        venue: "Management Science",
        links: {}
      },
      {
        year: 2024, type: "peer",
        title: "Paying Them to Hate US: Effect of U.S. Military Aid on Anti-American Terrorism, 1968-2018",
        authors: "with T. Krieger & D. Meierrieks",
        venue: "The Economic Journal",
        links: { paper: "https://doi.org/10.1093/ej/ueae034", open: "https://drive.google.com/file/d/1YHvdv6fOfoQUbydwCObyPQAIQ-qjM_0C/view" }
      },
      {
        year: 2024, type: "peer",
        title: "Measuring Norm Pluralism and Perceived Polarization in U.S. Politics",
        authors: "with F. Panizza, E. Kimbrough & A. Vostroknutov",
        venue: "Proceedings of the National Academy of Sciences (PNAS) Nexus",
        links: {}
      },
      {
        year: 2024, type: "peer",
        title: "Unraveling Polarization: Insight into Individual & Collective Dynamics",
        authors: "with K. Kish Bar-On, Y. Lelkes & D. Rand",
        venue: "Proceedings of the National Academy of Sciences (PNAS) Nexus",
        links: {}
      },
      {
        year: 2024, type: "peer",
        title: "Polarization in Multidisciplinary Perspective",
        authors: "with E. Kimbrough",
        venue: "Proceedings of the National Academy of Sciences (PNAS) Nexus",
        links: {}
      },
      {
        year: 2024, type: "peer",
        title: "Motivated Information Acquisition and Social Norm Formation",
        authors: "with F. Galeotti & M. C. Villeval",
        venue: "European Economic Review",
        links: {}
      },
      {
        year: 2024, type: "peer",
        title: "Social norms: Enforcement, Breakdown & Polarization",
        authors: "with L. Balafoutas, S. Gächter & E. Krupka",
        venue: "European Economic Review",
        links: {}
      },

      // 2023
      {
        year: 2023, type: "peer",
        title: "Beyond Average: A Method for Measuring the Tightness, Looseness, and Polarization of Social Norms.",
        authors: "",
        venue: "Economics Letters",
        links: {}
      },
      {
        year: 2023, type: "peer",
        title: "Synthesis of Evidence for Policy from Behavioural Science During COVID-19",
        authors: "collaboration led by K. Ruggeri & J. van Bavel",
        venue: "Nature",
        links: {}
      },
      {
        year: 2023, type: "peer",
        title: "Competition & Moral Behavior: Meta-Analysis of 45 Crowd-Sourced Experimental Designs",
        authors: "collaboration led by C. Huber, A. Dreber, et al.",
        venue: "Proceedings of the National Academy of Sciences (PNAS)",
        links: {}
      },
      {
        year: 2023, type: "peer",
        title: "Nudging Enforcers: How Norm Perceptions and Motives for Lying Shape Sanctions",
        authors: "with T. Gesche",
        venue: "Proceedings of the National Academy of Sciences (PNAS) Nexus",
        links: {}
      },
      {
        year: 2023, type: "peer",
        title: "It's Not A Lie if You Believe the Norm Does Not Apply: Conditional Norm-Following and Belief Distortion",
        authors: "with C. Bicchieri & S. Sonderegger",
        venue: "Games & Economic Behavior",
        links: {}
      },

      // 2022
      {
        year: 2022, type: "peer",
        title: "Social Norms and Behavior Change: The Interdisciplinary Research Frontier",
        authors: "with C. Bicchieri, M. Gelfand & S. Sonderegger",
        venue: "Journal of Economic Behavior & Organization",
        links: {}
      },
      {
        year: 2022, type: "peer",
        title: "Politicizing Mask-Wearing: Predicting the Success of Behavioral Interventions Among Republicans and Democrats in the U.S.",
        authors: "with K. Findley, C. Bicchieri & A. Hilbig",
        venue: "Scientific Reports",
        links: {}
      },
      {
        year: 2022, type: "peer",
        title: "Social Proximity and the Erosion of Norm Compliance",
        authors: "with A. Jacobsen, M. Kurschilgen & J. Ziegelmeyer",
        venue: "Journal of Economic Behavior & Organization",
        links: {}
      },
      {
        year: 2022, type: "peer",
        title: "Beyond Belief: How Social Norms Shape the Acceptance of Evidence",
        authors: "with A. Schmitz",
        venue: "The International Journal of Communication",
        links: {}
      },
      {
        year: 2022, type: "peer",
        title: "Persuading Republicans and Democrats to Comply with Mask-Wearing: An Intervention Tournaments Experiment",
        authors: "with A. Hilbig, K. Findley & C. Bicchieri",
        venue: "Scientific Reports",
        links: {}
      },
      {
        year: 2022, type: "peer",
        title: "Meta-Nudging Honesty: Past, Present and Future of the Research Frontier on Honesty in Behavioral Science",
        authors: "collaboration led by N. Mazar, J. H. Abeler, et al.",
        venue: "Journal of Economic Behavior & Organization",
        links: {}
      },
      {
        year: 2022, type: "peer",
        title: "Authoritarian Leaders Share Conspiracy Theories to Increase Regime Support and Promote Distrust in Science",
        authors: "",
        venue: "The International Journal of Communication",
        links: {}
      },

      // 2021
      {
        year: 2021, type: "peer",
        title: "Observability and Social Image: Incentivizing Public Service Provision Through a Field Experiment in Tanzania",
        authors: "with J. A. Bonilla & P. Justesen",
        venue: "Journal of Public Economics",
        links: {}
      },
      {
        year: 2021, type: "peer",
        title: "Efficient Institutions and Effective Deterrence: On Timing and Uncertainty of Punishment",
        authors: "with J. Buckenmaier, D. Posten & U. Schmidt",
        venue: "International Economic Review",
        links: {}
      },
      {
        year: 2021, type: "peer",
        title: "The Experience is (Not) Everything: Sequential Outcomes and Social Decision-Making",
        authors: "with J. Buckenmaier",
        venue: "Economics Letters",
        links: {}
      },
      {
        year: 2021, type: "peer",
        title: "Deviant or Wrong? The Effects of Norm Information on the Efficacy of Punishment",
        authors: "with C. Bicchieri & E. Xiao",
        venue: "Journal of Economic Behavior & Organization",
        links: {}
      },
      {
        year: 2021, type: "peer",
        title: "Understanding Cross-Cultural Differences in Peer Reporting Practices: Evidence from Tax Evasion Games in Moldova & France",
        authors: "with R. Romaniuc, D. Dubois, A. Lupusor & V. Prohnitchi",
        venue: "Public Choice",
        links: {}
      },

      // 2020
      {
        year: 2020, type: "peer",
        title: "Requiem for a Nudge: Framing Effects in Nudging Honesty",
        authors: "with G. Van Kleef & S. Shalvi",
        venue: "Journal of Economic Behavior & Organization",
        links: {}
      },
      {
        year: 2020, type: "peer",
        title: "The Economics of Corruption in Sports: The Special Case of Doping",
        authors: "with C. Deutscher",
        venue: "Handbook of Sports (chapter)",
        links: {}
      },

      // 2019
      {
        year: 2019, type: "peer",
        title: "Nudging with Care: The Risks and Benefits of Social Information",
        authors: "with C. Bicchieri",
        venue: "Public Choice",
        links: {}
      },
      {
        year: 2019, type: "peer",
        title: "Contagion of Pro- and Anti-Social Behavior Among Peers and the Role of Social Proximity",
        authors: "",
        venue: "Journal of Economic Psychology",
        links: {}
      },

      // 2018
      {
        year: 2018, type: "peer",
        title: "Effects of Institutional History and Leniency on Collusive Corruption and Tax Evasion",
        authors: "with J. Buckenmaier & L. Mittone",
        venue: "Journal of Economic Behavior & Organization",
        links: {}
      },
      {
        year: 2018, type: "peer",
        title: "Causes & Effects of Corruption: What has Past Decade's Empirical Research Taught Us?",
        authors: "with G. Tosato",
        venue: "Journal of Economic Surveys",
        links: {}
      },

      // 2016
      {
        year: 2016, type: "peer",
        title: "The Nature of Corruption – An Interdisciplinary Perspective",
        authors: "with T. Schulte",
        venue: "German Law Journal (special issue)",
        links: {}
      },

      // 2015
      {
        year: 2015, type: "peer",
        title: "A Crook is a Crook...But is He Still a Crook Abroad? On the Effect of Immigration on Destination-Country Corruption",
        authors: "with T. Krieger and M. Redlin",
        venue: "German Economic Review",
        links: {}
      },

      // 2013
      {
        year: 2013, type: "peer",
        title: "The Effect of Corruption on Migration, 1985-2000",
        authors: "with T. Krieger and D. Meierrieks",
        venue: "Applied Economics Letters",
        links: {}
      },

      // Work in Progress
      {
        year: 2025, type: "wip",
        title: "Promoting Responsible Disposal of Opioids: A Randomized Evaluation of Behaviorally Informed Messaging Combined with a Financial Incentive",
        authors: "with M. Toma and colleagues from DOJ, State, VA, and OES",
        venue: "Revise & Resubmit: Health Economics",
        status: "Revise & Resubmit",
        links: { paper: "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4502634" }
      },
      {
        year: 2025, type: "wip",
        title: "Aid and Exodus: U.S. Military Assistance and Refugee Flows to the U.S.",
        authors: "with T. Krieger, D. Meierrieks & L. Renner",
        venue: "Under Review",
        status: "Under Review",
        links: { paper: "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=5414817" }
      },
      {
        year: 2025, type: "wip",
        title: "Pluralism Breeds Tolerance",
        authors: "with F. Panizza, E. Kimbrough & A. Vostroknutov",
        venue: "Under Review",
        status: "Under Review",
        links: {
          paper: "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4649792",
          materials: "https://osf.io/7hc9v"
        }
      },
      {
        year: 2025, type: "wip",
        title: "The Price of Identity: Overoptimism and Congruence Concerns",
        authors: "with K. Donkor, L. Goette, M. Kurschilgen & M. Müller",
        venue: "Under Review",
        status: "Under Review",
        links: { paper: "https://papers.ssrn.com/abstract=4670092" }
      },
      {
        year: 2025, type: "wip",
        title: "Making Information Stick: Goal Setting and Attention",
        authors: "with A. Guido et al.",
        venue: "Under Review",
        status: "Under Review",
        links: { paper: "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4989494" }
      },
      {
        year: 2025, type: "wip",
        title: "Divided we Act: The Role of Social Sanctions in a Polarized World",
        authors: "with M. Gelfand, A. Hochleitner & S. Sonderegger",
        venue: "Under Review",
        status: "Under Review",
        links: { paper: "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=5636792" }
      },
      {
        year: 2021, type: "wip",
        title: "Becoming Friends or Foes? How Exposure to Competitive Environments and Social Proximity Shape Social Preferences",
        authors: "with A. Cao, K. Hyndman & N. Yang",
        venue: "Working Paper",
        status: "Working Paper",
        links: { paper: "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3326107" }
      }
    ];

    // -------------------------
    // Helpers
    // -------------------------
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
    const toastEl = $("#toast");

    function showToast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      setTimeout(() => toastEl.classList.remove("show"), 2200);
    }

    function norm(s){ return (s || "").toLowerCase(); }
    function escapeHtml(s){
      return (s || "").replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[c]));
    }

    function makeScholarSearchUrl(title){
      const q = encodeURIComponent(title);
      return "https://scholar.google.com/scholar?q=" + q;
    }

    // Tags are derived only from text that appears in the title (or venue/status).
    const TAGS = [
      { key: "social norms", needle: "norm" },
      { key: "polarization", needle: "polariz" },
      { key: "honesty", needle: "honest" },
      { key: "corruption", needle: "corrupt" },
      { key: "migration", needle: "migrat" },
      { key: "terrorism", needle: "terror" },
      { key: "inequality", needle: "inequal" },
      { key: "mask-wearing", needle: "mask" },
      { key: "covid-19", needle: "covid" },
      { key: "punishment", needle: "punish" },
      { key: "tax evasion", needle: "tax evasion" },
      { key: "competition", needle: "competit" },
      { key: "identity", needle: "identity" },
      { key: "opioids", needle: "opioid" },
      { key: "refugee", needle: "refugee" }
    ];

    function deriveTags(pub){
      const t = norm(pub.title + " " + (pub.venue || "") + " " + (pub.status || ""));
      return TAGS.filter(x => t.includes(x.needle)).map(x => x.key);
    }

    // -------------------------
    // State
    // -------------------------
    let activeTab = "peer";
    let selectedYears = new Set();
    let selectedTopics = new Set();

    // -------------------------
    // UI init
    // -------------------------
    $("#yearNow").textContent = new Date().getFullYear();

    // Nav active state
    const navLinks = $$("[data-nav]");
    const sections = ["home","research","vita","misc","contact"].map(id => $("#" + id));

    const io = new IntersectionObserver(entries => {
      const visible = entries.filter(e => e.isIntersecting).sort((a,b)=>b.intersectionRatio-a.intersectionRatio)[0];
      if(!visible) return;
      const id = visible.target.id;
      navLinks.forEach(a => a.classList.toggle("active", a.getAttribute("href") === "#" + id));
    }, { root: null, threshold: [0.2, 0.35, 0.5] });
    sections.forEach(s => s && io.observe(s));

    // Copy site link
    $("#copyLinkBtn").addEventListener("click", async () => {
      try{
        await navigator.clipboard.writeText(location.href.split("#")[0] + "#home");
        showToast("Copied link.");
      }catch(e){
        showToast("Could not copy. You can copy from the address bar.");
      }
    });

    // Tabs
    $$(".tab").forEach(btn => {
      btn.addEventListener("click", () => {
        $$(".tab").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        activeTab = btn.dataset.tab;
        render();
      });
    });

    // Year chips
    const years = Array.from(new Set(pubs.filter(p => p.type === "peer").map(p => p.year))).sort((a,b)=>b-a);
    const yearsAll = Array.from(new Set(pubs.map(p => p.year))).sort((a,b)=>b-a);

    function renderYearChips(){
      const host = $("#yearChips");
      host.innerHTML = "";
      const useYears = (activeTab === "peer") ? years : yearsAll;
      useYears.forEach(y => {
        const count = pubs.filter(p => p.type === activeTab && p.year === y).length;
        const chip = document.createElement("button");
        chip.type = "button";
        chip.className = "chip" + (selectedYears.has(y) ? " active" : "");
        chip.innerHTML = `${y} <small>${count}</small>`;
        chip.addEventListener("click", () => {
          if(selectedYears.has(y)) selectedYears.delete(y); else selectedYears.add(y);
          chip.classList.toggle("active");
          render();
        });
        host.appendChild(chip);
      });
    }

    // Topic chips (derived)
    function getTopics(){
      const set = new Set();
      pubs.filter(p => p.type === activeTab).forEach(p => deriveTags(p).forEach(t => set.add(t)));
      return Array.from(set).sort((a,b)=>a.localeCompare(b));
    }

    function renderTopicChips(){
      const host = $("#topicChips");
      host.innerHTML = "";
      const topics = getTopics();
      topics.forEach(t => {
        const count = pubs.filter(p => p.type === activeTab).filter(p => deriveTags(p).includes(t)).length;
        const chip = document.createElement("button");
        chip.type = "button";
        chip.className = "chip" + (selectedTopics.has(t) ? " active" : "");
        chip.innerHTML = `${escapeHtml(t)} <small>${count}</small>`;
        chip.addEventListener("click", () => {
          if(selectedTopics.has(t)) selectedTopics.delete(t); else selectedTopics.add(t);
          chip.classList.toggle("active");
          render();
        });
        host.appendChild(chip);
      });
    }

    // Reset
    $("#resetBtn").addEventListener("click", () => {
      $("#q").value = "";
      selectedYears.clear();
      selectedTopics.clear();
      $("#onlyOpen").checked = false;
      $("#groupByYear").checked = true;
      $("#sort").value = "year_desc";
      render();
      showToast("Reset.");
    });

    // Share filtered link
    $("#shareBtn").addEventListener("click", async () => {
      const params = new URLSearchParams();
      if(activeTab !== "peer") params.set("tab", activeTab);
      const q = $("#q").value.trim();
      if(q) params.set("q", q);
      if(selectedYears.size) params.set("y", Array.from(selectedYears).sort((a,b)=>b-a).join(","));
      if(selectedTopics.size) params.set("t", Array.from(selectedTopics).join(","));
      if($("#onlyOpen").checked) params.set("open", "1");
      if(!$("#groupByYear").checked) params.set("group", "0");
      params.set("sort", $("#sort").value);

      const link = location.origin + location.pathname + "#research" + (params.toString() ? "?" + params.toString() : "");
      try{
        await navigator.clipboard.writeText(link);
        showToast("Copied filtered link.");
      }catch(e){
        showToast("Could not copy. You can copy from the address bar.");
      }
    });

    // Controls rerender
    $("#q").addEventListener("input", () => render());
    $("#onlyOpen").addEventListener("change", () => render());
    $("#groupByYear").addEventListener("change", () => render());
    $("#sort").addEventListener("change", () => render());
    $("#jumpYear").addEventListener("change", () => {
      const y = $("#jumpYear").value;
      if(!y) return;
      const el = document.getElementById("year-" + y);
      if(el) el.scrollIntoView({behavior:"smooth", block:"start"});
      $("#jumpYear").value = "";
    });

    // Parse query params after hash (format: #research?x=y)
    function parseHashParams(){
      const hash = location.hash || "";
      const idx = hash.indexOf("?");
      if(idx === -1) return new URLSearchParams();
      return new URLSearchParams(hash.slice(idx + 1));
    }
    function applyParams(){
      const p = parseHashParams();
      const tab = p.get("tab");
      if(tab === "wip"){
        activeTab = "wip";
        $$(".tab").forEach(b => b.classList.toggle("active", b.dataset.tab === "wip"));
      }
      const q = p.get("q");
      if(q) $("#q").value = q;

      const ys = (p.get("y") || "").split(",").map(x => parseInt(x,10)).filter(x => !Number.isNaN(x));
      ys.forEach(y => selectedYears.add(y));

      const ts = (p.get("t") || "").split(",").map(x => x.trim()).filter(Boolean);
      ts.forEach(t => selectedTopics.add(t));

      $("#onlyOpen").checked = p.get("open") === "1";
      $("#groupByYear").checked = p.get("group") !== "0";
      const sort = p.get("sort");
      if(sort) $("#sort").value = sort;
    }

    window.addEventListener("hashchange", () => {
      // do not auto-apply on every hash change to avoid surprises
    });

    // -------------------------
    // Render
    // -------------------------
    function matches(pub){
      if(pub.type !== activeTab) return false;

      const q = norm($("#q").value.trim());
      if(q){
        const hay = norm(pub.title + " " + (pub.authors||"") + " " + (pub.venue||"") + " " + (pub.status||""));
        if(!hay.includes(q)) return false;
      }

      if(selectedYears.size && !selectedYears.has(pub.year)) return false;

      if(selectedTopics.size){
        const tags = deriveTags(pub);
        for(const t of selectedTopics){
          if(!tags.includes(t)) return false;
        }
      }

      if($("#onlyOpen").checked){
        const hasOpen = !!(pub.links && (pub.links.open || pub.links.pdf || pub.links.ungated || pub.links.materials));
        if(!hasOpen) return false;
      }

      return true;
    }

    function sortItems(items){
      const mode = $("#sort").value;
      const copy = items.slice();
      if(mode === "year_asc") copy.sort((a,b)=>a.year-b.year || a.title.localeCompare(b.title));
      if(mode === "year_desc") copy.sort((a,b)=>b.year-a.year || a.title.localeCompare(b.title));
      if(mode === "title_asc") copy.sort((a,b)=>a.title.localeCompare(b.title));
      return copy;
    }

    function pubLinks(pub){
      const links = pub.links || {};
      const out = [];

      const paper = links.paper || "";
      const open = links.open || links.pdf || links.ungated || "";
      const materials = links.materials || "";

      // Primary: use direct paper link if present, else Scholar search
      out.push({
        label: paper ? "Paper" : "Find on Scholar",
        href: paper ? paper : makeScholarSearchUrl(pub.title),
        primary: true
      });

      if(open){
        out.push({ label: "Open PDF", href: open });
      } else {
        out.push({ label: "Open-access search", href: "https://www.google.com/search?q=" + encodeURIComponent(pub.title + " pdf") });
      }

      if(materials){
        out.push({ label: "Materials", href: materials });
      }

      out.push({ label: "Copy citation", action: "cite" });

      return out;
    }

    async function copyCitation(pub){
      const a = pub.authors ? pub.authors.replace(/^with\s+/i,"") : "";
      const cite = `${a ? a + ". " : ""}${pub.year}. ${pub.title}. ${pub.venue || ""}`.trim();
      try{
        await navigator.clipboard.writeText(cite);
        showToast("Citation copied.");
      }catch(e){
        showToast("Could not copy citation.");
      }
    }

    function renderJump(items){
      const sel = $("#jumpYear");
      const years = Array.from(new Set(items.map(p=>p.year))).sort((a,b)=>b-a);
      sel.innerHTML = `<option value="">Jump to year…</option>` + years.map(y => `<option value="${y}">${y}</option>`).join("");
    }

    function renderList(items){
      const host = $("#list");
      host.innerHTML = "";

      const group = $("#groupByYear").checked;
      if(!items.length){
        host.innerHTML = `<div class="pub"><div class="meta">No results. Try a different keyword, clear year chips, or switch tabs.</div></div>`;
        return;
      }

      if(!group){
        items.forEach(pub => host.appendChild(renderPub(pub)));
        return;
      }

      const byYear = new Map();
      items.forEach(p => {
        if(!byYear.has(p.year)) byYear.set(p.year, []);
        byYear.get(p.year).push(p);
      });

      Array.from(byYear.keys()).sort((a,b)=>b-a).forEach(y => {
        const block = document.createElement("div");
        block.className = "year-block";
        block.id = "year-" + y;

        const title = document.createElement("div");
        title.className = "year-title";
        title.innerHTML = `<h3>${y}</h3><a class="jump" href="#research">Back to filters</a>`;
        block.appendChild(title);

        byYear.get(y).forEach(pub => block.appendChild(renderPub(pub)));
        host.appendChild(block);
      });
    }

    function renderPub(pub){
      const el = document.createElement("article");
      el.className = "pub";

      const tags = deriveTags(pub);
      const badges = [];
      badges.push(`<span class="badge"><strong>${pub.year}</strong></span>`);
      if(pub.type === "wip" && pub.status) badges.push(`<span class="badge warn"><strong>${escapeHtml(pub.status)}</strong></span>`);
      if(pub.links && (pub.links.open || pub.links.pdf || pub.links.ungated)) badges.push(`<span class="badge ok"><strong>open</strong></span>`);
      tags.slice(0,4).forEach(t => badges.push(`<span class="badge">${escapeHtml(t)}</span>`));

      const meta = [
        pub.authors ? `<em>${escapeHtml(pub.authors)}</em>` : "",
        pub.venue ? escapeHtml(pub.venue) : ""
      ].filter(Boolean).join(" · ");

      const links = pubLinks(pub).map(l => {
        if(l.action === "cite"){
          return `<button class="link" type="button" data-cite="1">Copy citation</button>`;
        }
        const cls = "link" + (l.primary ? " primary" : "");
        const rel = "noreferrer noopener";
        const target = "_blank";
        return `<a class="${cls}" href="${escapeHtml(l.href)}" target="${target}" rel="${rel}">${escapeHtml(l.label)}</a>`;
      }).join("");

      el.innerHTML = `
        <div class="top">
          <div>
            <h4>${escapeHtml(pub.title)}</h4>
            <div class="meta">${meta}</div>
          </div>
          <div class="badges">${badges.join("")}</div>
        </div>
        <div class="links">${links}</div>
      `;

      const citeBtn = el.querySelector("[data-cite='1']");
      if(citeBtn){
        citeBtn.addEventListener("click", () => copyCitation(pub));
      }

      return el;
    }

    function render(){
      renderYearChips();
      renderTopicChips();

      const items = sortItems(pubs.filter(matches));
      $("#count").textContent = `${items.length} result${items.length === 1 ? "" : "s"} · ${activeTab === "peer" ? "peer-reviewed" : "work in progress"}`;
      renderJump(items);
      renderList(items);
    }

    // Init from link params
    applyParams();
    render();

    // Smooth scroll offset fix for sticky header
    function scrollWithOffset(id){
      const el = document.getElementById(id);
      if(!el) return;
      const y = el.getBoundingClientRect().top + window.pageYOffset - 78;
      window.scrollTo({ top: y, behavior: "smooth" });
    }
    navLinks.forEach(a => {
      a.addEventListener("click", (e) => {
        const href = a.getAttribute("href") || "";
        if(!href.startsWith("#")) return;
        const id = href.slice(1);
        if(!id) return;
        e.preventDefault();
        history.replaceState(null, "", "#" + id);
        scrollWithOffset(id);
      });
    });
  </script>
</body>
</html>
